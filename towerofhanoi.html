<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tower of Hanoi</title>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.4/dist/confetti.browser.min.js"></script>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

    :root {
        --disk-color-1: #ff6b6b;
        --disk-color-2: #f06595;
        --disk-color-3: #cc5de8;
        --disk-color-4: #845ef7;
        --disk-color-5: #5c7cfa;
        --disk-color-6: #339af0;
        --disk-color-7: #22b8cf;
        --tower-color: #495057;
        --tower-base-color: #343a40;
        --background-gradient: linear-gradient(135deg, #74ebd5 0%, #acb6e5 100%);
    }

    body {
        font-family: 'Poppins', sans-serif;
        background: var(--background-gradient);
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        overflow: hidden;
    }

    .container {
        text-align: center;
        background: rgba(255, 255, 255, 0.15);
        padding: 2em;
        border-radius: 20px;
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.18);
        color: #333;
    }

    h1 {
        font-weight: 600;
        color: #2c3e50;
    }

    .game-area {
        display: flex;
        justify-content: space-around;
        margin: 2em 0;
        padding: 1em;
        border-radius: 10px;
    }

    .tower {
        width: 180px;
        height: 280px;
        border-bottom: 15px solid var(--tower-base-color);
        display: flex;
        flex-direction: column-reverse;
        align-items: center;
        position: relative;
        margin: 0 1em;
        padding-bottom: 5px;
        transition: background-color 0.3s;
    }

    .tower:before {
        content: '';
        position: absolute;
        bottom: 0;
        width: 12px;
        height: 250px;
        background-color: var(--tower-color);
        border-radius: 6px 6px 0 0;
    }
    
    .tower:hover {
        background-color: rgba(255, 255, 255, 0.2);
    }

    .disk {
        height: 28px;
        border-radius: 14px;
        cursor: pointer;
        margin-bottom: 3px;
        display: flex;
        justify-content: center;
        align-items: center;
        color: white;
        font-weight: 600;
        font-size: 0.9em;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        transition: transform 0.3s ease-in-out, box-shadow 0.3s ease;
    }

    .disk1 { width: 60px; background: var(--disk-color-1); }
    .disk2 { width: 80px; background: var(--disk-color-2); }
    .disk3 { width: 100px; background: var(--disk-color-3); }
    .disk4 { width: 120px; background: var(--disk-color-4); }
    .disk5 { width: 140px; background: var(--disk-color-5); }
    .disk6 { width: 160px; background: var(--disk-color-6); }
    .disk7 { width: 180px; background: var(--disk-color-7); }

    .tower.selected-tower {
        background-color: rgba(255, 255, 255, 0.3);
    }
    
    .disk.selected {
        transform: translateY(-60px);
        box-shadow: 0 15px 30px rgba(0,0,0,0.3);
    }

    button {
        background: #5c7cfa;
        color: white;
        border: none;
        padding: 12px 24px;
        font-size: 1em;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        margin: 0.5em;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    }
    
    input[type="number"] {
        width: 60px;
        padding: 8px;
        border-radius: 5px;
        border: 1px solid #ccc;
        text-align: center;
    }

    @media (max-width: 768px) {
        .container {
            width: 95%;
            padding: 1em;
        }
        .game-area {
            flex-direction: column;
            align-items: center;
        }
        .tower {
            width: 100%;
            margin: 1em 0;
            height: auto;
            min-height: 200px;
        }
    }
</style>
</head>
<body>

<div class="container">
    <h1 id="game-title">Tower of Hanoi</h1>
    <p>Move all disks to the last tower. Only smaller disks may sit on larger ones.</p>

    <div class="game-area">
        <div class="tower" id="tower0"></div>
        <div class="tower" id="tower1"></div>
        <div class="tower" id="tower2"></div>
    </div>

    <h3>Moves: <span id="moveCount">0</span></h3>

    <div>
        <label for="disk-count">Number of Disks:</label>
        <input type="number" id="disk-count" value="5" min="3" max="7" onchange="setupGame()">
        <button onclick="setupGame()">New Game</button>
        <button onclick="solveGame()">Auto Solve</button>
    </div>
</div>

<script>
    const towersEl = [document.getElementById('tower0'), document.getElementById('tower1'), document.getElementById('tower2')];
    let towers = [];
    let moveCount = 0;
    let selectedTower = null;
    let diskCount = 5;

    function setupGame() {
        document.getElementById('game-title').textContent = 'Tower of Hanoi';
        diskCount = parseInt(document.getElementById('disk-count').value, 10);
        towers = Array.from({ length: 3 }, () => []);
        towers[0] = Array.from({ length: diskCount }, (_, i) => diskCount - i);
        moveCount = 0;
        selectedTower = null;
        render();
    }

    function render() {
        towersEl.forEach(towerEl => towerEl.innerHTML = '');
        towers.forEach((diskStack, towerIndex) => {
            diskStack.forEach(diskSize => {
                const disk = document.createElement('div');
                disk.classList.add('disk', `disk${diskSize}`);
                disk.dataset.size = diskSize;
                disk.textContent = diskSize;
                towersEl[towerIndex].appendChild(disk);
            });
        });
        document.getElementById('moveCount').textContent = moveCount;
        updateTowerClickHandlers();
    }
    
    function updateTowerClickHandlers() {
        towersEl.forEach((towerEl, index) => {
            towerEl.onclick = () => handleTowerClick(index);
        });
    }

    function handleTowerClick(towerIndex) {
        if (selectedTower === null) {
            if (towers[towerIndex].length > 0) {
                selectedTower = towerIndex;
                towersEl[towerIndex].classList.add('selected-tower');
                const topDisk = towersEl[towerIndex].lastElementChild;
                if(topDisk) topDisk.classList.add('selected');
            }
        } else {
            const fromTower = selectedTower;
            const toTower = towerIndex;

            if (fromTower === toTower) { // Deselect
                selectedTower = null;
                towersEl.forEach(t => t.classList.remove('selected-tower'));
                document.querySelectorAll('.disk').forEach(d => d.classList.remove('selected'));
                return;
            }

            moveDisk(fromTower, toTower);
            
            selectedTower = null;
            towersEl.forEach(t => t.classList.remove('selected-tower'));
            document.querySelectorAll('.disk').forEach(d => d.classList.remove('selected'));

        }
    }

    function moveDisk(from, to) {
        const fromStack = towers[from];
        const toStack = towers[to];
        const diskToMove = fromStack[fromStack.length - 1];
        const topOfToStack = toStack[toStack.length - 1];

        if (!topOfToStack || diskToMove < topOfToStack) {
            fromStack.pop();
            toStack.push(diskToMove);
            moveCount++;
            render();
            checkWin();
        }
    }

    function checkWin() {
        if (towers[2].length === diskCount) {
            document.getElementById('game-title').textContent = `You won in ${moveCount} moves!`;
            confetti({
                particleCount: 150,
                spread: 80,
                origin: { y: 0.6 },
                ticks: 500,
                scalar: 1.3
            });
            setTimeout(() => {
                confetti({
                    particleCount: 200,
                    spread: 120,
                    origin: { y: 0.6 },
                    ticks: 500,
                    scalar: 1.3
                });
            }, 150);
        }
    }

    function solveGame() {
        setupGame();
        const moves = [];
        hanoi(diskCount, 0, 2, 1, moves);

        let i = 0;
        const interval = setInterval(() => {
            if (i >= moves.length) {
                clearInterval(interval);
                return;
            }
            const [from, to] = moves[i];
            moveDisk(from, to);
            i++;
        }, 500);
    }

    function hanoi(n, from, to, aux, moves) {
        if (n === 0) return;
        hanoi(n - 1, from, aux, to, moves);
        moves.push([from, to]);
        hanoi(n - 1, aux, to, from, moves);
    }
    
    // Initial setup
    setupGame();

</script>
</body>
</html>